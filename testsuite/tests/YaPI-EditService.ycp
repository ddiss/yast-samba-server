{

// test for Samba::EnableServer( boolean ) - enable/disable smb/nmb service
// $Id$
// testedfiles: Samba.ycp Service.ycp SambaServer.ycp Ldap.ycp

    include "testsuite.ycp";

    list rwe = [
            $[
                "target" : $[
                    "tmpdir" : "/tmp",
                    "size" : 0
                ]
            ],
            $[],
            $[
                "target" : $[
                    "bash_output" : $[]
                ]
            ]
        ];
    TESTSUITE_INIT(rwe, nil);
    import "YaPI::Samba";
    
    TEST( ``("Enable disabled service"), rwe, nil);

    // enable service, but it's disabled
    TEST( ``( YaPI::Samba::EditService( true ) ), [ 
	$[ "init" : $[ "scripts" : $[ "exists" : true ] ] ],
	$[],
	$[ "target" :$[ "bash_output" : 
	    $[
		"exit" : 0,
	    ]
	] ]
    ], nil );

    TEST( ``("Disable disabled service"), rwe, nil);

    // disable service, but it's already disabled
    TEST( ``( YaPI::Samba::EditService( false ) ), [
	$[ "init" : $[ "scripts" : $[ "exists" : true ] ] ],
	$[],
	$[ "target" :$[ "bash_output" : 
	    $[
		"exit" : 0,
	    ]
	] ]
    ], nil );

    TEST( ``("Enable enabled service"), rwe, nil);

    // enable service, but it's already enabled
    TEST( ``( YaPI::Samba::EditService( true ) ), [ 
	$[ 
	    "init" : $[ 
		"scripts" : $[ 
		    "exists" : true,
		    "runlevel" : $[
			"smbd" : $[
			    "start" : [ "2", "3", "5" ],
			],
			"nmbd" : $[
			    "start" : [ "2", "3", "5" ],
			],
		    ],
		],
	    ],
	    
	],
	$[],
	$[ "target" :$[ "bash_output" : 
	    $[
		"exit" : 0,
	    ]
	] ]
    ], nil );

    TEST( ``("Disable enabled service"), rwe, nil);

    // disable service, but it's enabled
    TEST( ``( YaPI::Samba::EditService( false ) ), [
	$[ 
	    "init" : $[ 
		"scripts" : $[ 
		    "exists" : true,
		    "runlevel" : $[
			"smbd" : $[
			    "start" : [ "2", "3", "5" ],
			],
			"nmbd" : $[
			    "start" : [ "2", "3", "5" ],
			],
		    ],
		],
	    ],
	    
	],
	$[],
	$[ "target" :$[ "bash_output" : 
	    $[
		"exit" : 0,
	    ]
	] ]
    ], nil );
}
