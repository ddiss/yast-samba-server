{

// test for SambaServer::setAsPDC()
// $Id$
// testedfiles: Samba.ycp SambaServer.ycp

    include "testsuite.ycp";
    
    list rwe = [
            $[
                "target" : $[
                    "tmpdir" : "/tmp",
                    "size" : 0
                ]
            ],
            $[],
            $[
                "target" : $[
                    "bash_output" : $[]
                ]
            ]
        ];
    TESTSUITE_INIT(rwe, nil);
    import "Samba";
    import "SambaServer";
    
    TEST( ``(SambaServer::role), rwe, nil);
    TEST( ``(Samba::security), rwe, nil);
    TEST( ``( sformat( "Domain logons: %1", SambaServer::global_config["domain logons"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Domain master: %1", SambaServer::global_config["domain master"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Local master: %1", SambaServer::global_config["local master"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Preferred master: %1", SambaServer::global_config["preferred master"]:nil) ), rwe, nil);
    
    Samba::modified = false;
    TEST( ``( SambaServer::setAsPDC() ), rwe, nil);

    TEST( ``(SambaServer::modified), rwe, nil);
    TEST( ``(SambaServer::role), rwe, nil);
    TEST( ``(Samba::security), rwe, nil);

    TEST( ``( sformat( "Domain logons: %1", SambaServer::global_config["domain logons"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Domain master: %1", SambaServer::global_config["domain master"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Local master: %1", SambaServer::global_config["local master"]:nil) ), rwe, nil);
    TEST( ``( sformat( "Preferred master: %1", SambaServer::global_config["preferred master"]:nil) ), rwe, nil);
}
